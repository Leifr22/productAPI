

# ProductAPI

Этот проект реализует HTTP API для работы с продуктами и категориями в SQL базе данных. API позволяет:

1. Получить список всех продуктов с их категориями.
2. Получить список всех категорий с их продуктами.
3. Получить список всех пар «Имя продукта – Имя категории».

## Возможности API

1. **Список всех продуктов с категориями**  
   Возвращает все продукты вместе с их категориями. Если у продукта нет категорий, он все равно отображается.

2. **Список всех категорий с продуктами**  
   Возвращает все категории вместе с продуктами. Если у категории нет продуктов, она все равно отображается.

3. **Список всех пар «Имя продукта – Имя категории»**  
   Возвращает все пары «Имя продукта – Имя категории». Пары создаются даже для продуктов без категорий или для категорий без продуктов.

## Технологии

- **Python**: язык программирования для реализации API.
- **FastAPI**: фреймворк для создания HTTP API.
- **SQLAlchemy**: ORM для работы с базой данных.
- **PostgreSQL**: используемая база данных.
- **Docker**: контейнеризация приложения.
- **Docker Compose**: для легкого развертывания приложения.
- **Pytest**: для написания и запуска юнит-тестов.

## Запуск проекта

1. Убедитесь, что на вашем компьютере установлен Docker и Docker Compose.
2. Клонируйте репозиторий:
   ```bash
   git clone https://github.com/Leifr22/productAPI.git
   cd productAPI
   ```
3. Запустите сервис с помощью `docker-compose`:
   ```bash
   docker-compose up --build
   ```
4. После запуска сервис будет доступен по адресу: `http://localhost:8000`.

## Эндпоинты API

1. **GET /products**  
   Возвращает список всех продуктов с их категориями.

2. **GET /categories**  
   Возвращает список всех категорий с их продуктами.

3. **GET /pairs**  
   Возвращает список всех пар «Имя продукта – Имя категории».

## Тестирование

Для обеспечения надежности и корректности сервиса написаны юнит-тесты, покрывающие основные функции API.

### Запуск тестов

1. Убедитесь, что проект и его зависимости установлены локально (если вы не используете Docker):
   ```bash
   pip install -r requirements.txt
   ```
2. Запустите тесты с помощью `pytest`:
   ```bash
   pytest
   ```
3. Для отображения покрытия кода выполните команду:
   ```bash
   pytest --cov=app
   ```
   После выполнения команды будет показана информация о покрытии кода.

### Пример покрытия тестов

Покрытие тестов отслеживает следующие модули:
- **API эндпоинты**: Проверка корректности возвращаемых результатов.
- **Модели данных**: Проверка работы с базой данных.
- **Вспомогательные функции**: Проверка корректности их работы.

**Цель**: максимально покрыть код тестами, чтобы обеспечить надежность сервиса.

## Пример `docker-compose.yml`

```yaml
version: '3.8'

services:
  app:
    build:
      context: .
    ports:
      - "8000:8000"
    depends_on:
      - db
    environment:
      - DATABASE_URL=postgresql://user:password@db:5432/product_db

  db:
    image: postgres:15
    environment:
      POSTGRES_USER: user
      POSTGRES_PASSWORD: password
      POSTGRES_DB: product_db
    ports:
      - "5432:5432"
```

